# План по интеграции volume для fly.io

## Текущая ситуация
- Все данные хранятся в папке `data/` в корне проекта
- При перезапуске бота на fly.io данные исчезают
- Необходимо использовать volume для постоянного хранения данных

## Требования
1. Использовать путь `/data` для volume на fly.io
2. Сохранять все файлы из папки `data/` в volume
3. Поддерживать два режима запуска:
   - `-dep` для деплоя (использует volume)
   - `-loc` для локального запуска (использует текущую папку data/)
4. При первом деплое, если volume пуст, копировать данные из локальной папки `data/` в volume

## План модификации

### 1. Модификация Dockerfile
- Добавить создание директории `/data` в контейнере
- Скопировать локальные данные в `/data` при первом запуске
- Использовать переменную окружения для определения режима

### 2. Модификация fly.toml
- Добавить конфигурацию volume для монтирования `/data`
- Указать размер volume (например, 1GB)

### 3. Модификация src/main.py
- Добавить обработку параметров командной строки `-dep` и `-loc`
- Определить путь к данным в зависимости от режима:
  - Для `-dep`: использовать `/data`
  - Для `-loc`: использовать `./data`
- Реализовать логику копирования данных при первом запуске в режиме `-dep`

### 4. Модификация src/config/settings.py
- Обновить пути к файлам данных для поддержки обоих режимов
- Добавить функцию для определения текущего режима работы

### 5. Модификация src/utils/backup_manager.py
- Обновить пути к файлам для резервного копирования
- Убедиться, что резервные копии создаются и восстанавливаются из правильного расположения

### 6. Тестирование
- Проверить работу в локальном режиме (`-loc`)
- Проверить работу в режиме деплоя (`-dep`)
- Убедиться, что данные сохраняются между перезапусками
- Проверить механизм копирования данных при первом деплое

### 7. Документация
- Обновить README с описанием новых параметров запуска
- Добавить инструкции по настройке volume для fly.io
- Описать процесс миграции данных при первом деплое

## Ожидаемый результат
- Бот сохраняет данные между перезапусками на fly.io
- Локальная разработка не затронута
- Простой процесс миграции данных при первом деплое
- Четкая документация для пользователей и разработчиков