# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤ –æ—Ç—á–µ—Ç–∞—Ö - –†–µ–∑—é–º–µ

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–í –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ –æ—Ç—á–µ—Ç–æ–≤ (`’æ’≥’°÷Ä’∏÷Ç’¥’∂’•÷Ä`) –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–ª–∞—Å—å –¥–≤–∞–∂–¥—ã –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ ID –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏.

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:
```
cb-92ceb989  06.12.2024  ’è’´’Ø’∏  ... 2025-08-03 19:12:40  2025-08-03 19:12:40
cb-92ceb989  06.12.2024  ’è’´’Ø’∏  ... 2025-07-30 13:43:38  2025-07-30 13:43:38
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ –æ—Ç—á–µ—Ç–æ–≤**
```python
# –ë–´–õ–û: –í—Å–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
for record in db_records:
    if record['supplier'] == display_name:
        filtered_records.append(record)

# –°–¢–ê–õ–û: –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ ID —Å –≤—ã–±–æ—Ä–æ–º —Å–∞–º–æ–π –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
unique_records = {}
for record in db_records:
    record_id = record.get('id')
    if record_id in unique_records:
        existing_updated = unique_records[record_id].get('updated_at', '')
        current_updated = record.get('updated_at', '')
        if current_updated > existing_updated:
            unique_records[record_id] = record
    else:
        unique_records[record_id] = record
```

### 2. **–§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```python
def remove_duplicate_records() -> int:
    """–£–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –æ—Å—Ç–∞–≤–ª—è—è —Å–∞–º—ã–µ –Ω–æ–≤—ã–µ"""
    # –ù–∞—Ö–æ–¥–∏–º –∑–∞–ø–∏—Å–∏ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ ID
    # –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–∞–º—É—é –Ω–æ–≤—É—é –ø–æ updated_at
    # –£–¥–∞–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ
```

### 3. **–ê–¥–º–∏–Ω—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ `/clean_duplicates`**
- –î–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∏ —É–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- –û—Ç—á–µ—Ç –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

## üìä –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `report_manager.py`
- `generate_user_report()` - –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `_generate_sheet_report()` - –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ª–∏—Å—Ç–∞  
- `generate_statistics_report()` - –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### `database_manager.py`
- `remove_duplicate_records()` - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –ë–î
- –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–∞—Ö

### `admin_commands.py`
- `clean_duplicates_command()` - –Ω–æ–≤–∞—è –∞–¥–º–∏–Ω—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞

### `bot_main.py`
- –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã `/clean_duplicates`

## üîß –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ ID**: –í—Å–µ –∑–∞–ø–∏—Å–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –ø–æ–ª—é `id`
2. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏**: –î–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è `updated_at`
3. **–í—ã–±–æ—Ä –Ω–æ–≤–µ–π—à–µ–π**: –û—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å —Å —Å–∞–º–æ–π –ø–æ–∑–¥–Ω–µ–π `updated_at`
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –ó–∞–ø–∏—Å–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ –æ—Ç—á–µ—Ç–∞—Ö
- ‚ùå –ù–µ—Ç–æ—á–Ω—ã–µ —Å—É–º–º—ã –≤ –æ—Ç—á–µ—Ç–∞—Ö
- ‚ùå –ó–∞–≤—ã—à–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –¢–æ—á–Ω—ã–µ —Å—É–º–º—ã –≤ –æ—Ç—á–µ—Ç–∞—Ö
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—á–∏—Å—Ç–∫–∏ –ë–î –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- –û—Ç—á–µ—Ç—ã —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
```bash
/clean_duplicates  # –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –ë–î
```

## üìã –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –¥–æ/–ø–æ—Å–ª–µ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
- –î–µ—Ç–∞–ª–∏ –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–æ–±–ª–µ–º–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤ –æ—Ç—á–µ—Ç–∞—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞! üéâ
