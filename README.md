# 🤖 CoordinatBot - Ֆինանսական հաշվապահության համակարգ


- [RUSSIAN DOCS](docs/README_RU.md)
- [ENGLISH DOCS](docs/README_EN.md)
- [README_NEW] (docs/README_NEW.md)
- [ARMENIAN README](docs/README_ARM.md)
- [MIGRATION REPORT](docs/MIGRATION.md)
- [RESTRUCTURE SUMMARY](docs/RESTRUCTURE_SUMMARY.md)
## 📋 Նկարագրություն

CoordinatBot-ը հզոր Telegram բոտ է ֆինանսական գրառումների կառավարման և Google Sheets-ի հետ ինտեգրացման համար: Բոտը նախատեսված է ծախսերի հետևման, հաշվետվությունների ստեղծման և աշխատակիցների վճարումների կառավարման համար:

## ✨ Հիմնական հնարավորություններ

### 📝 Գրառումների կառավարում
- ➕ Ծախսերի գրառումների ավելացում ինտերակտիվ մենյուի միջոցով
- ✏️ Գրառումների խմբագրում և ջնջում
- 🔍 Գրառումների որոնում և ֆիլտրացում
- 📊 Մանրամասն տեղեկատվություն յուրաքանչյուր գրառման մասին

### 🔄 Google Sheets ինտեգրացիա
- 📈 Ավտոմատ սինխրոնիզացիա Google Sheets-ի հետ
- 📋 Բազմաթիվ աղյուսակների և թերթերի աջակցություն
- 🔁 Երկկողմանի տվյալների սինխրոնիզացիա
- ⚡ Իրական ժամանակի թարմացումներ

### 📊 Հաշվետվություններ և վերլուծություն
- 📄 Excel ֆորմատով հաշվետվությունների ստեղծում
- 💰 Վճարումների և պարտքերի հետևում
- 📈 Վիճակագրական վերլուծություն
- 🏢 Անհատական հաշվետվություններ աշխատակիցների համար

### 👥 Բազմօգտագործողի աջակցություն
- 🔐 Անվտանգ օգտագործողների կառավարում
- 🛡️ Մուտքի թույլտվությունների համակարգ
- 👑 Ադմինիստրատորների հատուկ հնարավորություններ
- 📱 Օգտագործողական կարգավորումներ

## 🚀 Տեղադրում և կարգավորում

### Պահանջվող ծրագրեր
```bash
Python 3.8+
pip
Git
```

### 1. Նախագծի ստանում
```bash
git clone https://github.com/your-username/CoordinatBot.git
cd CoordinatBot
```

### 2. Վիրտուալ միջավայրի ստեղծում
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

### 3. Կախվածությունների տեղադրում
```bash
pip install -r requirements.txt
```

### 4. Շրջակա միջավայրի կարգավորում
Ստեղծեք `.env` ֆայլ և ավելացրեք անհրաժեշտ մուտքային տվյալները:

```env
# Telegram Bot Token
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Ադմինիստրատորների ID-ներ (ստորակետով բաժանված)
ADMIN_IDS=123456789,987654321

# Գրանցամատյանի մակարդակ
LOG_LEVEL=INFO
```

### 5. Google Sheets կարգավորում
1. Ստեղծեք Google Cloud Console նախագիծ
2. Միացրեք Google Sheets API
3. Ստեղծեք Service Account
4. Ներբեռնեք credentials JSON ֆայլը
5. Տեղադրեք այն `credentials/` պանակում

### 6. Տվյալների բազայի նախապատրաստում
```bash
python -c "from src.database.database_manager import DatabaseManager; DatabaseManager().init_db()"
```

### 7. Բոտի գործարկում
```bash
python main_new.py
```

## 📁 Նախագծի կառուցվածք

```
CoordinatBot/
├── 📁 src/                          # Հիմնական ծրագրային կոդ
│   ├── 📁 config/                   # Նախագծի կարգավորումներ
│   │   └── settings.py              # Գլոբալ կարգավորումներ
│   ├── 📁 bot/                      # Telegram բոտի տրամաբանություն
│   │   ├── 📁 handlers/             # Հրամանների և իրադարձությունների մշակիչներ
│   │   │   ├── basic_commands.py    # Հիմնական հրամաններ (/start, /help)
│   │   │   ├── admin_commands.py    # Ադմինիստրատիվ հրամաններ
│   │   │   ├── record_handlers.py   # Գրառումների ավելացման մշակիչներ
│   │   │   ├── edit_handlers.py     # Գրառումների խմբագրման մշակիչներ
│   │   │   └── callback_handlers.py # Կոճակների մշակիչներ
│   │   ├── 📁 keyboards/            # Ինտերակտիվ ստեղնաշարեր
│   │   │   └── inline_keyboards.py  # Ինլայն ստեղնաշարեր
│   │   └── 📁 states/               # ConversationHandler վիճակներ
│   │       └── conversation_states.py
│   ├── 📁 database/                 # Տվյալների բազայի մշակում
│   │   └── database_manager.py      # ՏԲ կառավարիչ
│   ├── 📁 google_integration/       # Google Sheets ինտեգրացիա
│   │   ├── sheets_manager.py        # Հիմնական գործողություններ
│   │   └── sync_manager.py          # Սինխրոնիզացիա
│   └── 📁 utils/                    # Օգտակար գործիքներ
│       ├── config_utils.py          # Կարգավորումների մշակում
│       ├── date_utils.py            # Ամսաթվային գործիքներ
│       ├── formatting.py            # Հաղորդագրությունների ֆորմատավորում
│       └── report_manager.py        # Հաշվետվությունների ստեղծում
├── 📁 data/                         # Տվյալների ֆայլեր
│   ├── users.json                   # Օգտագործողների տվյալներ
│   ├── allowed_users.json           # Թույլատրված օգտագործողներ
│   ├── bot_config.json              # Բոտի կարգավորումներ
│   └── expenses.db                  # SQLite տվյալների բազա
├── 📁 credentials/                  # Մուտքային տվյալներ
│   └── google-credentials.json      # Google API մուտքային տվյալներ
├── main_new.py                      # Հիմնական գործարկման ֆայլ
├── requirements.txt                 # Python կախվածություններ
├── .env                            # Շրջակա միջավայրի փոփոխականներ
└── README.md                       # Այս ֆայլը
```

## 🎮 Օգտագործման ուղեցույց

### Հիմնական հրամաններ

#### Օգտագործողական հրամաններ:
- `/start` - Բոտի գործարկում և գլխավոր մենյու
- `/menu` - Գլխավոր մենյուի ցուցադրում
- `/help` - Հրամանների օգնություն
- `/search [տեքստ]` - Գրառումների որոնում
- `/recent [N]` - Վերջին N գրառումների ցուցադրում
- `/info [ID]` - Գրառման մանրամասն տեղեկատվություն

#### Ադմինիստրատիվ հրամաններ:
- `/allow_user [ID]` - Օգտագործողի ավելացում
- `/disallow_user [ID]` - Օգտագործողի հեռացում
- `/allowed_users` - Թույլատրված օգտագործողների ցուցակ
- `/set_user_name [ID] [անուն]` - Օգտագործողի անվան սահմանում
- `/set_log` - Գրանցամատյանի չատի սահմանում
- `/set_report [ID] [անուն]` - Հաշվետվությունների կարգավորում
- `/export` - Տվյալների արտահանում JSON ֆորմատով
- `/sync_sheets` - Google Sheets-ի հետ սինխրոնիզացիա
- `/my_report [անուն]` - Անհատական հաշվետվության ստեղծում

### Գրառումների ավելացում

1. Սեղմեք "➕ Ծախս ավելացնել" կոճակը
2. Ընտրեք մատակարարի տիպը:
   - 👤 Ձեր անունը
   - 🏢 Ֆիրմայի անունը
   - ✏️ Ձեռքով մուտքագրել
3. Մուտքագրեք ուղղությունը
4. Մուտքագրեք ծախսի նկարագրությունը
5. Մուտքագրեք գումարը
6. Հաստատեք գրառումը

### Գրառումների խմբագրում

1. Գտեք գրառումը `/recent` կամ `/search` հրամանով
2. Սեղմեք "✏️ Խմբագրել" կոճակը
3. Ընտրեք խմբագրվող դաշտը
4. Մուտքագրեք նոր արժեքը
5. Հաստատեք փոփոխությունները

## 🔧 Տեխնիկական մանրամասներ

### Օգտագործված տեխնոլոգիաներ

- **Python 3.8+** - Հիմնական ծրագրավորման լեզու
- **python-telegram-bot** - Telegram Bot API-ի wrapper
- **SQLite** - Տվյալների բազա
- **pandas** - Տվյալների վերլուծություն
- **openpyxl** - Excel ֆայլերի մշակում
- **gspread** - Google Sheets API
- **python-dotenv** - Շրջակա միջավայրի կառավարում

### Ճարտարապետություն

Նախագիծը կառուցված է մոդուլային ճարտարապետության վրա՝ հստակ տարանջատմամբ հանցումների միջև:

#### Շերտեր:
1. **Ներկայացման շերտ** (`bot/handlers/`) - Telegram API-ի հետ փոխգործակցություն
2. **Գործարար տրամաբանության շերտ** (`utils/`) - Գործարար օրենքներ և տրամաբանություն
3. **Տվյալների շերտ** (`database/`) - Տվյալների պահպանում և բեռնում
4. **Ինտեգրացիայի շերտ** (`google_integration/`) - Արտաքին API-ների հետ ինտեգրացիա

### Տվյալների մոդել

#### Records (Գրառումներ)
- `id` - Եզակի նույնականացուցիչ
- `date` - Ամսաթիվ
- `supplier` - Մատակարար
- `direction` - Ուղղություն
- `description` - Նկարագրություն
- `amount` - Գումար
- `spreadsheet_id` - Google Sheets ID
- `sheet_name` - Թերթի անուն
- `user_id` - Օգտագործողի ID

#### Payments (Վճարումներ)
- `id` - Եզակի նույնականացուցիչ
- `user_display_name` - Օգտագործողի անուն
- `amount` - Գումար
- `date_from` - Վճարման սկզբի ամսաթիվ
- `date_to` - Վճարման վերջի ամսաթիվ
- `comment` - Մեկնաբանություն

## 🛡️ Անվտանգություն

### Մուտքի վերահսկում
- Միայն թույլատրված օգտագործողները կարող են մուտք գործել բոտ
- Ադմինիստրատիվ ֆունկցիաները սահմանափակված են որոշակի օգտագործողների համար
- Օգտագործողները կարող են խմբագրել միայն իրենց սեփական գրառումները

### Տվյալների պաշտպանություն
- Կարևոր տվյալները պահվում են շրջակա միջավայրի փոփոխականներում
- Տվյալների բազայի պարբերական կրկնօրինակում
- Գրանցամատյանի վարում բոլոր գործողությունների

## 📈 Մոնիտորինգ և գրանցամատյան

Բոտը ունի ընդգրկուն գրանցամատյանի համակարգ՝

- ℹ️ **INFO** - Հիմնական գործողություններ
- ⚠️ **WARNING** - Զգուշացումներ և անսովոր իրավիճակներ
- ❌ **ERROR** - Սխալներ և բացառություններ

Գրանցամատյանի մակարդակը կարող է կարգավորվել `.env` ֆայլում:

## 🔄 Տվյալների արտահանում և ներմուծում

### Ավտոմատ տվյալների արտահանում
Բոտը ստեղծում է ավտոմատ backup՝ JSON ֆորմատով `/export` հրամանի միջոցով:

### Ձեռքով backup
```bash
# Տվյալների բազայի backup
cp data/expenses.db backup/expenses_$(date +%Y%m%d_%H%M%S).db

# Կարգավորումների backup
cp data/*.json backup/
```

## 🚀 Արտադրական միջավայր

### Docker օգտագործման դեպքում
```bash
# Docker image-ի կառուցում
docker build -t coordinatbot .

# Գործարկում
docker run -d --name coordinatbot \
  --env-file .env \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/credentials:/app/credentials \
  coordinatbot
```

### Systemd Service ստեղծում (Linux)
```bash
sudo nano /etc/systemd/system/coordinatbot.service
```

```ini
[Unit]
Description=CoordinatBot Telegram Bot
After=network.target

[Service]
Type=simple
User=botuser
WorkingDirectory=/path/to/CoordinatBot
ExecStart=/path/to/CoordinatBot/venv/bin/python main_new.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable coordinatbot
sudo systemctl start coordinatbot
```

## 🤝 Ներդրում նախագծում

### Նոր ֆունկցիաների ավելացում

1. Ստեղծեք նոր branch
```bash
git checkout -b feature/new-feature
```

2. Ավելացրեք ձեր փոփոխությունները
3. Ստեղծեք Pull Request
4. Անցկացրեք code review

### Կոդային ստանդարտներ

- Հետևեք PEP 8 ստանդարտին
- Գրեք ապացուցիչներ (docstrings) բոլոր ֆունկցիաների համար
- Ավելացրեք unit տեստեր նոր ֆունկցիաների համար
- Պահպանեք մոդուլային ճարտարապետությունը

### Փորձարկում

```bash
# Unit տեստերի գործարկում
python -m pytest tests/

# Կոդի որակի ստուգում
flake8 src/
black src/
```

## ❓ Հաճախ տրվող հարցեր (FAQ)

### Ինչպես թարմացնել Telegram բոտի token-ը?
1. Խմբագրեք `.env` ֆայլը
2. Թարմացրեք `TELEGRAM_BOT_TOKEN` արժեքը
3. Վերագործարկեք բոտը

### Ինչպես ավելացնել նոր ադմինիստրատոր?
1. Ճանապարհեք օգտագործողի Telegram ID-ն
2. Ավելացրեք այն `ADMIN_IDS` ցանկում `.env` ֆայլում
3. Վերագործարկեք բոտը

### Ինչպես ստուգել Google Sheets կապը?
Օգտագործեք `/sync_sheets` հրամանը կամ ստուգեք լոգերը:

## 📞 Աջակցություն

Հարցերի կամ խնդիրների դեպքում դիմեք՝

- 📧 Email: support@coordinatbot.com
- 💬 Telegram: @coordinatbot_support
- 🐛 Issues: GitHub Issues բաժին

## 📄 Լիցենզիա

Այս նախագիծը հրապարակված է MIT լիցենզիայի ներքո: Մանրամասների համար տես `LICENSE` ֆայլը:

## 🔄 Փոփոխությունների պատմություն

### v2.0.0 (Մոդուլային վերակառուցում)
- ✨ Ամբողջական ճարտարապետական վերակառուցում
- 📁 Մոդուլային կառուցվածքի ներդրում
- 🔧 Բարելավված կոնֆիգուրացիա
- 📊 Ընդլայնված հաշվետվությունների համակարգ
- 🔄 Բարելավված Google Sheets սինխրոնիզացիա

### v1.0.0 (Առաջին հրատարակում)
- 🚀 Հիմնական ֆունկցիոնալություն
- 💰 Ծախսերի հաշվապահություն
- 📈 Google Sheets ինտեգրացիա
- 👥 Բազմօգտագործողի աջակցություն

## 🙏 Շնորհակալություն

Հատուկ շնորհակալություն՝

- Telegram Bot API թիմին
- Google Sheets API մշակողներին
- Բաց կոդի համայնքին
- Բոլոր աջակիցներին և ներդրողներին

---

**CoordinatBot** - Ձեր վստահելի գործընկերը ֆինանսական կառավարման մեջ! 💼✨

Այս նախագիծը կառուցված է ❤️-ով, որպեսզի դյուրացնի Ձեր ֆինանսական հաշվապահությունը:
