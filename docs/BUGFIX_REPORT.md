# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞—Ç –≤ pandas**
**–ü—Ä–æ–±–ª–µ–º–∞**: `UserWarning: Could not infer format, so each element will be parsed individually`

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ `payment_handlers.py`:
```python
# –ë—ã–ª–æ:
df['date'] = pd.to_datetime(df['date'], errors='coerce', dayfirst=True)

# –°—Ç–∞–ª–æ:
df['date'] = pd.to_datetime(df['date'], format='%d.%m.%Y', errors='coerce')
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ñ–∞–π–ª–∞—Ö**:
- `src/bot/handlers/payment_handlers.py` (3 –º–µ—Å—Ç–∞)

### 2. **–û—à–∏–±–∫–∞ ConversationHandler —Å–æ—Å—Ç–æ—è–Ω–∏–π**
**–ü—Ä–æ–±–ª–µ–º–∞**: `'start_add_payment' returned state 0 which is unknown to the ConversationHandler`

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ `payment_handlers.py`:
```python
# –ë—ã–ª–æ:
PAYMENT_AMOUNT, PAYMENT_PERIOD, PAYMENT_COMMENT = range(3)

# –°—Ç–∞–ª–æ:
from ..states.conversation_states import (
    PAYMENT_AMOUNT, PAYMENT_PERIOD, PAYMENT_COMMENT
)
```

### 3. **–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ callback'–∏**
**–ü—Ä–æ–±–ª–µ–º—ã**:
- `analytics_menu` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback
- `user_settings_menu` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback  
- `backup_menu` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback
- `add_language` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback
- `create_backup`, `backup_list`, `restore_backup`, `cleanup_backups` - –ø–æ–¥–º–µ–Ω—é —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- `user_list`, `add_user`, `user_permissions`, `user_stats` - –ø–æ–¥–º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `button_handlers.py`:

#### üìä Analytics Menu:
```python
async def analytics_menu(update: Update, context: CallbackContext):
    """–ú–µ–Ω—é –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"""
    # - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    # - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # - –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
    # - –û—Ç—á–µ—Ç—ã –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
```

#### üë• User Settings Menu:
```python
async def user_settings_menu(update: Update, context: CallbackContext):
    """–ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    # - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞
    # - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

#### üíæ Backup Menu:
```python
async def backup_menu(update: Update, context: CallbackContext):
    """–ú–µ–Ω—é —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è"""
    # - –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
    # - –°–ø–∏—Å–æ–∫ –∫–æ–ø–∏–π
    # - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∫–æ–ø–∏–∏
    # - –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–ø–∏–∏
```

#### üåç Add Language Menu:
```python
async def add_language_menu(update: Update, context: CallbackContext):
    """–ú–µ–Ω—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞"""
    # - –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π, –ù–µ–º–µ—Ü–∫–∏–π, –ò—Å–ø–∞–Ω—Å–∫–∏–π, –ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π
    # - –î—Ä—É–≥–æ–π —è–∑—ã–∫ (custom)
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### üéØ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏**:
- ‚úÖ **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è pandas** - –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è
- ‚úÖ **ConversationHandler** - —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- ‚úÖ **Callback'–∏** - –≤—Å–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### üìä **–î–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- ‚úÖ **–ú–µ–Ω—é –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** - –≥–æ—Ç–æ–≤–æ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** - –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–æ—Ç–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏
- ‚úÖ **–ü–æ–¥–º–µ–Ω—é —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ, —Å–ø–∏—Å–æ–∫, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –æ—á–∏—Å—Ç–∫–∞
- ‚úÖ **–ü–æ–¥–º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - —Å–ø–∏—Å–æ–∫, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø—Ä–∞–≤–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è**:
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —É–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —É–±—Ä–∞–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üöÄ **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã**:

### ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç**:
- üåê –°–∏—Å—Ç–µ–º–∞ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏ (3 —è–∑—ã–∫–∞)
- ‚öôÔ∏è –ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ (–∞–¥–º–∏–Ω—ã)
- üí∞ –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìä –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### üîÑ **–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**:
- üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üë• –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- üíæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- üåç –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤

## üìù **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**:

1. **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞**: `python src/main.py`
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**: –ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –∫–Ω–æ–ø–∫–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ**: –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è

## üî• **–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø** (2025-07-08):

### 4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ callback'–∏ –≤ –ø–æ–¥–º–µ–Ω—é**
**–ü—Ä–æ–±–ª–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤ –ª–æ–≥–∞—Ö**:
- `create_backup` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `backup_list` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `restore_backup` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `cleanup_backups` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `user_list` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `add_user` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `user_permissions` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- `user_stats` - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `button_handlers.py`:

```python
# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
elif data == "create_backup":
    await create_backup(update, context)
elif data == "backup_list":
    await backup_list(update, context)
elif data == "restore_backup":
    await restore_backup(update, context)
elif data == "cleanup_backups":
    await cleanup_backups(update, context)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
elif data == "user_list":
    await user_list(update, context)
elif data == "add_user":
    await add_user(update, context)
elif data == "user_permissions":
    await user_permissions(update, context)
elif data == "user_stats":
    await user_stats(update, context)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–¥–º–µ–Ω—é
elif data == "add_admin":
    await add_admin_handler(update, context)
elif data == "remove_admin":
    await remove_admin_handler(update, context)
elif data == "show_analytics":
    await show_analytics_handler(update, context)
elif data.startswith("select_backup_"):
    await select_backup_handler(update, context)
elif data.startswith("confirm_restore_"):
    await confirm_restore_handler(update, context)
elif data == "confirm_cleanup":
    await confirm_cleanup_handler(update, context)
elif data == "export_analytics":
    await export_analytics_handler(update, context)
```

### ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏-–∑–∞–≥–ª—É—à–∫–∏**:
- `add_admin_handler()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `remove_admin_handler()` - —É–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  
- `show_analytics_handler()` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- `select_backup_handler()` - –≤—ã–±–æ—Ä –±—ç–∫–∞–ø–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `confirm_restore_handler()` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `confirm_cleanup_handler()` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏
- `export_analytics_handler()` - —ç–∫—Å–ø–æ—Ä—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2025-07-08  
**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞**: 2025-07-08 20:30  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–ï CALLBACK'–ò –û–ë–†–ê–ë–û–¢–ê–ù–´**  
**–°–∏—Å—Ç–µ–º–∞**: üéØ **–ü–û–õ–ù–û–°–¢–¨–Æ –°–¢–ê–ë–ò–õ–¨–ù–ê**
