# –û—Ç—á–µ—Ç –æ–± —É–ª—É—á—à–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ—Ç—á–µ—Ç–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π

## üéØ –ó–∞–¥–∞—á–∞:
–û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ–±—ã –≤ –Ω–æ–≤–æ–π –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –Ω–∞ –∫–∞–∂–¥—ã–π –ª–∏—Å—Ç + –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ –≤ —Å—Ç–∞—Ä–æ–º `main.py`.

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è send_payment_report**
**–§–∞–π–ª**: `src/bot/handlers/payment_handlers.py`

**–ß—Ç–æ –±—ã–ª–æ**:
- –°–æ–∑–¥–∞–≤–∞–ª—Å—è –æ–¥–∏–Ω Excel —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ –ª–∏—Å—Ç–∞–º–∏
- –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º

**–ß—Ç–æ —Å—Ç–∞–ª–æ**:
- **–û—Ç–¥–µ–ª—å–Ω—ã–π Excel —Ñ–∞–π–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞** —Å —Ç—Ä–µ–º—è –≤–∫–ª–∞–¥–∫–∞–º–∏:
  - `‘æ’°’≠’Ω’•÷Ä` - –≤—Å–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –¥–∞–Ω–Ω–æ–º—É –ª–∏—Å—Ç—É
  - `‘±’¥÷É’∏÷É` - –∏—Ç–æ–≥–æ–≤—ã–µ —Å—É–º–º—ã –ø–æ –ª–∏—Å—Ç—É
  - `’é’≥’°÷Ä’∏÷Ç’¥’∂’•÷Ä` - –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –¥–∞–Ω–Ω–æ–º—É –ª–∏—Å—Ç—É (—Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤)

- **–ò—Ç–æ–≥–æ–≤—ã–π Excel —Ñ–∞–π–ª** —Å–æ —Å–≤–æ–¥–∫–æ–π –ø–æ –≤—Å–µ–º –ª–∏—Å—Ç–∞–º:
  - `‘±’¥÷É’∏÷É` - –∏—Ç–æ–≥–∏ –ø–æ –≤—Å–µ–º –ª–∏—Å—Ç–∞–º (—Ä–∞—Å—Ö–æ–¥—ã, –ø–ª–∞—Ç–µ–∂–∏, –æ—Å—Ç–∞—Ç–∫–∏)
  - `‘≤’∏’¨’∏÷Ä ’æ’≥’°÷Ä’∏÷Ç’¥’∂’•÷Ä’®` - –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –≤—Å–µ–º –ª–∏—Å—Ç–∞–º

### 2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pandas` –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —á–µ—Ä–µ–∑ `merge_payment_intervals()`
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç —á–µ—Ä–µ–∑ `format_date_for_interval()`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

### 3. **–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
–ö–∞–∂–¥—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ü–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö
- –ò—Ç–æ–≥–æ–≤—ã–µ —Å—É–º–º—ã
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –ø–ª–∞—Ç–µ–∂–µ–π —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ –¥–∞—Ç
- –û—Å—Ç–∞—Ç–∫–∏ –∫ –¥–æ–ø–ª–∞—Ç–µ

## ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

### –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:
```
üìã ‘π’•÷Ä’©: [–ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞]
üí∞ ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’Æ’°’≠’Ω: [–°—É–º–º–∞] ’§÷Ä’°’¥
üíµ ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’æ’≥’°÷Ä: [–°—É–º–º–∞] ’§÷Ä’°’¥
üí∏ ’Ñ’∂’°÷Å’∏÷Ä’§: [–û—Å—Ç–∞—Ç–æ–∫] ’§÷Ä’°’¥
```

### –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
```
üìä ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’∞’°’∑’æ’•’ø’æ’∏÷Ç’©’µ’∏÷Ç’∂ [–ò–º—è]-’´ ’∞’°’¥’°÷Ä

üí∞ ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’Æ’°’≠’Ω: [–û–±—â–∞—è —Å—É–º–º–∞] ’§÷Ä’°’¥
üíµ ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’æ’≥’°÷Ä: [–û–±—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏] ’§÷Ä’°’¥
üí∏ ‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’¥’∂’°÷Å’∏÷Ä’§: [–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫] ’§÷Ä’°’¥

üìã ‘π’•÷Ä’©’´’Ø’∂’•÷Ä’´ ÷Ñ’°’∂’°’Ø: [–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç–æ–≤]
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

1. **–ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏** - –≤—Å–µ –æ—Ç—á–µ—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Ä–∞–Ω—å—à–µ
2. **–û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞** - —É–¥–æ–±–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
3. **–ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞** - –æ–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –ø–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º
4. **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π** - —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
5. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –Ω–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pandas.ExcelWriter` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç –∏ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ `payment_utils`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
