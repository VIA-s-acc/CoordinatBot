# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ callback'–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
Callback `add_payment_’ç’°’¥’æ’•’¨` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞, –≤—ã–∑—ã–≤–∞—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
```
WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: add_payment_’ç’°’¥’æ’•’¨ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞ –µ—Å–ª–∏ –º–µ–Ω—é –Ω–∞–¥–∞—Ç—å
```

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω button_handlers.py**
**–§–∞–π–ª**: `src/bot/handlers/button_handlers.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**:
- –£–ª—É—á—à–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ callback'–æ–≤ `add_payment_`
- –£–±—Ä–∞–Ω–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —ç—Ç–∏—Ö callback'–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è ConversationHandler'–æ–º

### 2. **–£–ª—É—á—à–µ–Ω ConversationHandler –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π**
**–§–∞–π–ª**: `src/bot/handlers/conversation_handlers.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- `allow_reentry=True` - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥ –≤ ConversationHandler
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `CallbackQueryHandler(start_add_payment, pattern="^add_payment_")` –≤–æ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö
- Fallback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞

### 3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ per_message**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `per_message=True` –¥–ª—è ConversationHandler'–æ–≤ —Å CallbackQueryHandler'–∞–º–∏
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö callback'–æ–≤

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:

1. **Callback'–∏ add_payment_ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è** –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
2. **–£–±—Ä–∞–Ω—ã –ª–æ–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** –æ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö callback'–∞—Ö
3. **ConversationHandler –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π** —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥
4. **–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫** –≤ –Ω–æ–≤–æ–π –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

## üéØ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

1. –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–∞–∫–∫–∞—É–Ω—Ç
2. –í—ã–±—Ä–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ’ç’°’¥’æ’•’¨)
3. –ù–∞–∂–∞—Ç—å "‘±’æ’•’¨’°÷Å’∂’•’¨ ’æ’≥’°÷Ä’∏÷Ç’¥"
4. –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é –∏ —Å–Ω–æ–≤–∞ –Ω–∞–∂–∞—Ç—å "‘±’æ’•’¨’°÷Å’∂’•’¨ ’æ’≥’°÷Ä’∏÷Ç’¥"
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ callback –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ `per_message` –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã
- –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
