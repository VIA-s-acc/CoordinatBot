# CoordinatBot - ิฟีกีฆีดีกีฏีฅึีบีพีกีฎ ีถีกีญีกีฃีฎีซ ีฏีกีผีธึึีพีกีฎึ

Telegram ีขีธีฟ ีฎีกีญีฝีฅึีซ ีฏีกีผีกีพีกึีดีกีถ ึ Google Sheets-ีซ ีฐีฅีฟ ีซีถีฟีฅีฃึีดีกีถ ีฐีกีดีกึึ

## ีีธึ ีถีกีญีกีฃีฎีซ ีฏีกีผีธึึีพีกีฎึ

```
CoordinatBot/
โโโ ๐ src/                          # ิฑีฒีขีตีธึึีซ ีฏีธีค
โ   โโโ ๐ config/                   # ิฟีธีถึีซีฃีธึึีกึีซีก
โ   โ   โโโ __init__.py
โ   โ   โโโ settings.py              # ีีซีดีถีกีฏีกีถ ีฏีกึีฃีกีพีธึีธึีดีถีฅึ
โ   โโโ ๐ bot/                      # ิฒีธีฟีซ ีฟึีกีดีกีขีกีถีธึีฉีตีธึีถ
โ   โ   โโโ __init__.py
โ   โ   โโโ bot_main.py              # ิฒีธีฟีซ ีฃีฌีญีกีพีธึ ึีกีตีฌ
โ   โ   โโโ ๐ handlers/             # ีึีกีฐีกีถีฃีถีฅึีซ ีดีทีกีฏีซีนีถีฅึ
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ basic_commands.py    # ีีซีดีถีกีฏีกีถ ีฐึีกีฐีกีถีฃีถีฅึ (/start, /help)
โ   โ   โ   โโโ admin_commands.py    # ิฑีคีดีซีถีซีฝีฟึีกีฟีธึีซ ีฐึีกีฐีกีถีฃีถีฅึ
โ   โ   โ   โโโ record_commands.py   # ิณึีกีผีธึีดีถีฅึีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึีซ ีฐึีกีฐีกีถีฃีถีฅึ
โ   โ   โ   โโโ callback_handlers.py # ิฟีธีณีกีฏีถีฅึีซ ีดีทีกีฏีซีนีถีฅึ
โ   โ   โ   โโโ conversation_handlers.py # ConversationHandlers
โ   โ   โ   โโโ error_handler.py     # ีีญีกีฌีถีฅึีซ ีดีทีกีฏีซีน
โ   โ   โโโ ๐ keyboards/            # ีีฟีฅีฒีถีกีทีกึีฅึ
โ   โ   โ   โโโ __init__.py
โ   โ   โ   โโโ inline_keyboards.py  # Inline ีฝีฟีฅีฒีถีกีทีกึีฅึ
โ   โ   โโโ ๐ states/               # ิตึีฏีญีธีฝีธึีฉีตีธึีถีถีฅึีซ ีพีซีณีกีฏีถีฅึ
โ   โ       โโโ __init__.py
โ   โ       โโโ conversation_states.py
โ   โโโ ๐ database/                 # ีีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึ
โ   โ   โโโ __init__.py
โ   โ   โโโ database_manager.py      # ีีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีดีฅีถีฅีปีฅึ
โ   โโโ ๐ google_integration/       # Google-ีซ ีฐีฅีฟ ีซีถีฟีฅีฃึีธึีด
โ   โ   โโโ __init__.py
โ   โ   โโโ sheets_manager.py        # Google Sheets ีดีฅีถีฅีปีฅึ
โ   โโโ ๐ utils/                    # ีีชีกีถีคีกีฏ ีฃีธึีฎีซึีถีฅึ
โ       โโโ __init__.py
โ       โโโ config_utils.py          # ิฟีธีถึีซีฃีธึึีกึีซีกีตีซ ึีชีกีถีคีกีฏ ีฃีธึีฎีซึีถีฅึ
โ       โโโ date_utils.py            # ิฑีดีฝีกีฉีพีฅึีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึีซ ีฃีธึีฎีซึีถีฅึ
โ       โโโ formatting.py           # ีีกีฒีธึีคีกีฃึีธึีฉีตีธึีถีถีฅึีซ ึีธึีดีกีฟีกีพีธึีธึีด
โโโ ๐ data/                         # ีีกีพีฅีฌีพีกีฎีซ ีฟีพีตีกีฌีถีฅึ
โ   โโโ users.json                   # ีีฃีฟีกีฟีฅึีฅึีซ ีฟีพีตีกีฌีถีฅึ
โ   โโโ allowed_users.json           # ินีธึีตีฌีกีฟึีพีกีฎ ึีฃีฟีกีฟีฅึีฅึีซ ึีกีถีฏ
โ   โโโ bot_config.json              # ิฒีธีฟีซ ีฏีธีถึีซีฃีธึึีกึีซีก
โ   โโโ expenses.db                  # ีีพีตีกีฌีถีฅึีซ ีขีกีฆีก
โ   โโโ bot.log                      # ิผีธีฃีฅึ
โโโ ๐ credentials/                  # ีีกีพีกีฟีกึีดีกีฃึีฅึ
โ   โโโ coordinate-462818-8da128264452.json # Google Service Account
โโโ ๐ old_files/                    # ีีซีถ ึีกีตีฌีฅึ (ีฐีฒีธึีดีถีฅึีซ ีฐีกีดีกึ)
โ   โโโ main.py                      # ีีซีถ ีฃีฌีญีกีพีธึ ึีกีตีฌ
โ   โโโ database.py                  # ีีซีถ ีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีดีธีคีธึีฌ
โ   โโโ google_connector.py          # ีีซีถ Google ีดีธีคีธึีฌ
โโโ main_new.py                      # ีีธึ ีดีธึีฟึีซ ีฏีฅีฟ
โโโ requirements.txt                 # ิฟีกีญีพีกีฎีธึีฉีตีธึีถีถีฅึ
โโโ .env.example                     # ีีซีปีกีพีกีตึีซ ึีกีตีฌีซ ึึีซีถีกีฏ
โโโ .env                            # ีีซีปีกีพีกีตึีซ ึีกีตีฌ (git-ีธึีด ีนีซ ีฌีซีถีซ)
โโโ .gitignore                      # ิฑีถีฟีฅีฝีพีธีฒ ึีกีตีฌีฅึ
โโโ README.md                       # ิฑีตีฝ ึีกีตีฌีจ
```

## ีีซีดีถีกีฏีกีถ ีขีกึีฅีฌีกีพีธึีดีถีฅึ

### ๐๏ธ ีีธีคีธึีฌีกีตีซีถ ีณีกึีฟีกึีกีบีฅีฟีธึีฉีตีธึีถ
- **ีีกีฟีกีฝีญีกีถีกีฟีพีธึีฉีตีธึีถีถีฅึีซ ีขีกีชีกีถีธึีด**: ีตีธึึีกึีกีถีนีตีธึึ ีดีธีคีธึีฌ ีบีกีฟีกีฝีญีกีถีกีฟีธึ ีง ีซึ ีธีฌีธึีฟีซ ีฐีกีดีกึ
- **ีีกีฐีบีกีถีดีกีถ ีฐีฅีทีฟีธึีฉีตีธึีถ**: ึีธึีธีญีธึีฉีตีธึีถีถีฅึีจ ีฟีฅีฒีกีตีถีกึีพีกีฎ ีฅีถ ีฐีกีดีกีบีกีฟีกีฝีญีกีถ ีดีธีคีธึีฌีถีฅึีธึีด
- **ิฟีธีคีซ ีพีฅึีกึีฃีฟีกีฃีธึีฎีธึีด**: ีจีถีคีฐีกีถีธึึ ึีชีกีถีคีกีฏ ีฃีธึีฎีซึีถีฅึีจ ีขีกึีกีฐีกีตีฟีพีกีฎ ีฅีถ ีกีผีกีถีฑีซีถ ีดีธีคีธึีฌีถีฅึีธึีด

### ๐ ีีกีตีฌีฅึีซ ีฏีกีฆีดีกีฏีฅึีบีธึีด
- **config/**: ิฟีฅีถีฟึีธีถีกึีพีกีฎ ีฏีธีถึีซีฃีธึึีกึีซีก
- **bot/**: Telegram ีขีธีฟีซ ีกีดีขีธีฒีป ีฟึีกีดีกีขีกีถีธึีฉีตีธึีถีจ
- **database/**: ีีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึ
- **google_integration/**: Google ีฎีกีผีกีตีธึีฉีตีธึีถีถีฅึีซ ีฐีฅีฟ ีซีถีฟีฅีฃึีธึีด
- **utils/**: ีีชีกีถีคีกีฏ ึีธึีถีฏึีซีกีถีฅึ

### ๐ง ิฒีกึีฅีฌีกีพีพีกีฎ ีฏีธีถึีซีฃีธึึีกึีซีก
- ีีซีปีกีพีกีตึีซ ึีธึีธีญีกีฏีกีถีถีฅึีซ ึีฃีฟีกีฃีธึีฎีธึีด (.env)
- ิฟีฅีถีฟึีธีถีกึีพีกีฎ ีฏีกึีฃีกีพีธึีธึีดีถีฅึ `settings.py`-ีธึีด
- ิณีกีฒีฟีถีซ ีฟีพีตีกีฌีถีฅึีซ ีขีกีชีกีถีธึีด

### ๐ ีีพีตีกีฌีถีฅึีซ ีฏีกีผีกีพีกึีธึีด
- ิฑีผีกีถีฑีซีถ `data/` ีฉีฒีฉีกีบีกีถีกีฏ ีขีธีฌีธึ ีฟีพีตีกีฌีถีฅึีซ ึีกีตีฌีฅึีซ ีฐีกีดีกึ
- ิฑีผีกีถีฑีซีถ `credentials/` ีฉีฒีฉีกีบีกีถีกีฏ ีฐีกีพีกีฟีกึีดีกีฃึีฅึีซ ีฐีกีดีกึ
- ิผีธีฃีฅึีจ ีกีผีกีถีฑีซีถ ึีกีตีฌีธึีด

## ีีฅีฒีกีคึีธึีด ึ ีฃีธึีฎีกึีฏีธึีด

### 1. ีีฅีบีธีฆีซีฟีธึีซีกีตีซ ีฏีฌีธีถีกีพีธึีธึีด
```bash
git clone <repository_url>
cd CoordinatBot
```

### 2. ีีซึีฟีธึีกีฌ ีดีซีปีกีพีกีตึีซ ีฝีฟีฅีฒีฎีธึีด
```bash
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate
```

### 3. ิฟีกีญีพีกีฎีธึีฉีตีธึีถีถีฅึีซ ีฟีฅีฒีกีคึีธึีด
```bash
pip install -r requirements.txt
```

### 4. ีีซีปีกีพีกีตึีซ ีฏีกึีฃีกีพีธึีธึีด
```bash
# ีีกีฟีณีฅีถีฅึ ีดีซีปีกีพีกีตึีซ ึีกีตีฌีซ ึึีซีถีกีฏีจ
cp .env.example .env

# ิฝีดีขีกีฃึีฅึ .env ึีกีตีฌีจ ึ ีฌึีกึึีฅึ ีกีถีฐึีกีชีฅีทีฟ ีกึีชีฅึีถีฅึีจ:
# - TELEGRAM_BOT_TOKEN
# - ADMIN_IDS
```

### 5. Google ีฐีกีพีกีฟีกึีดีกีฃึีฅึีซ ีฟีฅีฒีกีคึีธึีด
ีีฅีฒีกีคึีฅึ Google Service Account-ีซ JSON ึีกีตีฌีจ `credentials/` ีฉีฒีฉีกีบีกีถีกีฏีธึีด

### 6. ิฒีธีฟีซ ีฃีธึีฎีกึีฏีธึีด
```bash
python main_new.py
```

## ิฟีธีถึีซีฃีธึึีกึีซีก

### ีีซีปีกีพีกีตึีซ ึีธึีธีญีกีฏีกีถีถีฅึ (.env)
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
ADMIN_IDS=123456789,987654321
```

### ีีพีตีกีฌีถีฅึีซ ีฏีกีผีธึึีพีกีฎึ
- `data/users.json` - ึีฃีฟีกีฟีฅึีฅึีซ ีฏีกึีฃีกีพีธึีธึีดีถีฅึ
- `data/allowed_users.json` - ีฉีธึีตีฌีกีฟึีพีกีฎ ึีฃีฟีกีฟีฅึีฅึีซ ึีกีถีฏ
- `data/bot_config.json` - ีขีธีฟีซ ีฏีธีถึีซีฃีธึึีกึีซีก
- `data/expenses.db` - SQLite ีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีก
- `data/bot.log` - ีฌีธีฃีฅึีซ ึีกีตีฌ

## ีีซีถ ีฟีกึีขีฅึีกีฏีซึ ีดีซีฃึีกึีซีก

### ีีกีตีฌีฅึีซ ีกีพีฟีธีดีกีฟ ีฟีฅีฒีกึีธีญีธึีด
ิณีธึีฎีกึีฏีฅึ ีดีซีฃึีกึีซีกีตีซ ีฝีฏึีซีบีฟีจ (ีกีผีกีถีฑีซีถ ีฝีฟีฅีฒีฎีฅีฌ):
```bash
python migrate_old_structure.py
```

### ีีฅีผึีธีพ ีฟีฅีฒีกึีธีญีธึีด
1. ีีฅีฒีกึีธีญีฅึ ีฐีซีถ ีฟีพีตีกีฌีถีฅึีซ ึีกีตีฌีฅึีจ `data/` ีฉีฒีฉีกีบีกีถีกีฏ:
   - `users.json` โ `data/users.json`
   - `allowed_users.json` โ `data/allowed_users.json`
   - `bot_config.json` โ `data/bot_config.json`
   - `expenses.db` โ `data/expenses.db`

2. ีีฅีฒีกึีธีญีฅึ Google ีฐีกีพีกีฟีกึีดีกีฃึีฅึีจ `credentials/` ีฉีฒีฉีกีบีกีถีกีฏ

3. ีีฟีฅีฒีฎีฅึ `.env` ึีกีตีฌี ีฐีซีดีถีพีฅีฌีธีพ `.env.example`-ีซ ีพึีก

## ีีทีกีฏีธึีด

### ีีธึ ีฐึีกีฐีกีถีฃีถีฅึีซ ีกีพีฅีฌีกึีธึีด
1. ีีฟีฅีฒีฎีฅึ ีดีทีกีฏีซีน ีฐีกีดีกีบีกีฟีกีฝีญีกีถ ึีกีตีฌีธึีด `src/bot/handlers/` ีฉีฒีฉีกีบีกีถีกีฏีธึีด
2. ิณึีกีถึีฅึ ีดีทีกีฏีซีนีจ `src/bot/bot_main.py`-ีธึีด

### ีีธึ ึีชีกีถีคีกีฏ ีฃีธึีฎีซึีถีฅึีซ ีกีพีฅีฌีกึีธึีด
1. ีีฟีฅีฒีฎีฅึ ีดีธีคีธึีฌ `src/utils/` ีฉีฒีฉีกีบีกีถีกีฏีธึีด
2. ิปีดีบีธึีฟ ีกึีฅึ ีธึีฟีฅีฒ ีกีถีฐึีกีชีฅีทีฟ ีง

### ีีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึ
ีีฃีฟีกีฃีธึีฎีฅึ `DatabaseManager`-ีจ `src/database/database_manager.py`-ีซึ

### Google Sheets-ีซ ีฐีฅีฟ ีกีทีญีกีฟีกีถึ
ีีฃีฟีกีฃีธึีฎีฅึ `GoogleSheetsManager`-ีจ `src/google_integration/sheets_manager.py`-ีซึ

## ิผีธีฃีกีพีธึีธึีด

ิผีธีฃีฅึีจ ีฃึีกีถึีพีธึีด ีฅีถ `data/bot.log` ึีกีตีฌีธึีด ึ ึีธึึีกีคึีพีธึีด ีฅีถ ีฏีธีถีฝีธีฌีธึีดึ
ิผีธีฃีกีพีธึีดีกีถ ีดีกีฏีกึีคีกีฏีจ ีฏีกึีฃีกีพีธึีพีธึีด ีง `LOG_LEVEL` ีดีซีปีกีพีกีตึีซ ึีธึีธีญีกีฏีกีถีธึีดึ

## ิฑีถีพีฟีกีถีฃีธึีฉีตีธึีถ

- ิฒีธีฌีธึ ีฃีกีฒีฟีถีซ ีฟีพีตีกีฌีถีฅึีจ `.env` ึีกีตีฌีธึีด
- `.env` ึีกีตีฌีจ ีกีพีฅีฌีกึีพีกีฎ ีง `.gitignore`-ีธึีด
- Google ีฐีกีพีกีฟีกึีดีกีฃึีฅึีจ ีกีผีกีถีฑีซีถ `credentials/` ีฉีฒีฉีกีบีกีถีกีฏีธึีด
- ีีกีพีฅีฌีพีกีฎีซ ีฟีพีตีกีฌีถีฅึีจ ีกีผีกีถีฑีซีถ `data/` ีฉีฒีฉีกีบีกีถีกีฏีธึีด

## TODO

### ิฒีกึีฑึ ีกีผีกีปีถีกีฐีฅึีฉีธึีฉีตีธึีถ
- [ ] ิฒีธีฌีธึ ีดีทีกีฏีซีนีถีฅึีซ ีดีซีฃึีกึีซีก ีฐีซีถ `main.py`-ีซึ
- [ ] ConversationHandler-ีถีฅึีซ ีซึีกีฏีกีถีกึีธึีด ีฃึีกีผีธึีดีถีฅึีซ ีกีพีฅีฌีกึีดีกีถ/ีญีดีขีกีฃึีดีกีถ ีฐีกีดีกึ
- [ ] Google Sheets-ีซ ีฐีฅีฟ ีกีดีขีธีฒีปีกีฏีกีถ ีซีถีฟีฅีฃึีธึีด
- [ ] ีีกีทีพีฅีฟีพีธึีฉีตีธึีถีถีฅึีซ ึ ีพีฅึีฌีธึีฎีธึีฉีตีกีถ ีฐีกีดีกีฏีกึีฃ

### ีีซีปีซีถ ีกีผีกีปีถีกีฐีฅึีฉีธึีฉีตีธึีถ  
- [ ] ิฒีธีฌีธึ ีดีธีคีธึีฌีถีฅึีซ ีฐีกีดีกึ ีดีซีกีพีธึ ีฉีฅีฝีฟีฅึ
- [ ] API ึีกีฝีฟีกีฉีฒีฉีกีฏึีธึีฉีตีธึีถ
- [ ] Docker ีฏีธีถีฟีฅีตีถีฅีผีกึีธึีด
- [ ] ีีกีฐีธึีฝีฟีกีตีซีถ ีบีกีฟีณีฅีถีถีฅึีซ ีฐีกีดีกีฏีกึีฃ

### ีีกีฎึ ีกีผีกีปีถีกีฐีฅึีฉีธึีฉีตีธึีถ
- [ ] ิฑีคีดีซีถีซีฝีฟึีดีกีถ ีพีฅีข ีซีถีฟีฅึึีฅีตีฝ
- [ ] ิฑีตีฌ ีฎีกีผีกีตีธึีฉีตีธึีถีถีฅึีซ ีฐีฅีฟ ีซีถีฟีฅีฃึีธึีด
- [ ] ิฒีกีฆีดีกีฌีฅีฆีพีธึีฉีตีธึีถ
- [ ] ิพีกีถีธึึีธึีดีถีฅึีซ ีฐีกีดีกีฏีกึีฃ

## ิฑีปีกีฏึีธึีฉีตีธึีถ

ิฝีถีคีซึีถีฅึีซ ีฎีกีฃีดีกีถ ีคีฅีบึีธึีด:
1. ีีฟีธึีฃีฅึ ีฌีธีฃีฅึีจ `data/bot.log` ึีกีตีฌีธึีด
2. ีีกีดีธีฆีพีฅึ ีฏีธีถึีซีฃีธึึีกึีซีกีตีซ ีณีทีฟีธึีฉีตีธึีถีจ `.env` ึีกีตีฌีธึีด
3. ีีฟีธึีฃีฅึ ีฟีพีตีกีฌีถีฅึีซ ึีกีตีฌีฅึีซ ึ ีฐีกีพีกีฟีกึีดีกีฃึีฅึีซ ีดีธึีฟึีซ ีซึีกีพีธึีถึีถีฅึีจ
